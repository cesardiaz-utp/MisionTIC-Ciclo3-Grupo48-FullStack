{"remainingRequest":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/src/views/products/Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/src/views/products/Edit.vue","mtime":1633396429640},{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/cache-loader/dist/cjs.js","mtime":1632359997990},{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/thread-loader/dist/cjs.js","mtime":1632359997990},{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/babel-loader/lib/index.js","mtime":1632359998900},{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/cache-loader/dist/cjs.js","mtime":1632359997990},{"path":"/home/cdiaz/MisionTIC/ciclo3/fullstack-g48/front/node_modules/vue-loader/lib/index.js","mtime":1632359999180}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgaW5zZXJ0UHJvZHVjdCwKICBnZXRQcm9kdWN0LAogIHVwZGF0ZVByb2R1Y3QsCiAgaW5zZXJ0UHJvZHVjdFdpdGhJbWFnZSwKfSBmcm9tICIuLi8uLi9zZXJ2aWNlcy9Qcm9kdWN0cy5zZXJ2aWNlIjsKaW1wb3J0IFN1Y2Nlc3NNZXNzYWdlIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvU3VjY2Vzc01lc3NhZ2UudnVlIjsKaW1wb3J0IEVycm9yTWVzc2FnZSBmcm9tICIuLi8uLi9jb21wb25lbnRzL0Vycm9yTWVzc2FnZS52dWUiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIFN1Y2Nlc3NNZXNzYWdlLAogICAgRXJyb3JNZXNzYWdlLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAiTmV3IHByb2R1Y3QiLAogICAgICBjb2RlOiAwLAogICAgICBuYW1lOiAiIiwKICAgICAgcHJpY2U6IDAsCiAgICAgIGNhdGVnb3JpZXM6IFtdLAogICAgICBpbWFnZTogbnVsbCwKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgc3VjY2Vzc01lc3NhZ2U6ICIiLAogICAgICBzdWNjZXNzU2hvdzogZmFsc2UsCiAgICAgIGVycm9yTWVzc2FnZTogIiIsCiAgICAgIGVycm9yU2hvdzogZmFsc2UsCiAgICAgIHJ1bGVzOiBbKHZhbHVlKSA9PiAhIXZhbHVlIHx8ICJSZXF1ZXJpZG8uIl0sCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGNvbnNvbGUubG9nKCJ0aWVuZSBjb2RlOiAiICsgdGhpcy4kcm91dGUucGFyYW1zLmNvZGUpOwogICAgY29uc3QgY29kZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5jb2RlOwogICAgaWYgKGNvZGUgIT0gdW5kZWZpbmVkKSB7CiAgICAgIGdldFByb2R1Y3QoY29kZSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGNvbnN0IHByb2R1Y3QgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgdGhpcy5jb2RlID0gcHJvZHVjdC5jb2RlOwogICAgICAgICAgdGhpcy5uYW1lID0gcHJvZHVjdC5uYW1lOwogICAgICAgICAgdGhpcy5wcmljZSA9IHByb2R1Y3QucHJpY2U7CiAgICAgICAgICB0aGlzLmNhdGVnb3JpZXMgPSBwcm9kdWN0LmNhdGVnb3JpZXM7CgogICAgICAgICAgdGhpcy50aXRsZSA9ICJFZGl0IHByb2R1Y3QiOwogICAgICAgICAgdGhpcy5pc0VkaXQgPSB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKCgpID0+IHRoaXMub3BlbkVycm9yRGlhbG9nKCJEYXRvcyBubyBlbmNvbnRyYWRvcyIpKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGd1YXJkYXIoKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLmNvZGUgPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgdGhpcy5jb2RlID09ICIiIHx8CiAgICAgICAgdGhpcy5uYW1lID09IHVuZGVmaW5lZCB8fAogICAgICAgIHRoaXMubmFtZSA9PSAiIiB8fAogICAgICAgIHRoaXMucHJpY2UgPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgdGhpcy5wcmljZSA9PSAiIgogICAgICApIHsKICAgICAgICB0aGlzLm9wZW5FcnJvckRpYWxvZygiSW5ncmVzZSBsb3MgY2FtcG9zIG9ibGlnYXRvcmlvcyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGV0IHJlcXVlc3QgPSBudWxsOwogICAgICBpZiAodGhpcy5pbWFnZSAhPSBudWxsICYmIHRoaXMuaW1hZ2UgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc3QgcHJvZHVjdCA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIHByb2R1Y3QuYXBwZW5kKCJjb2RlIiwgdGhpcy5jb2RlKTsKICAgICAgICBwcm9kdWN0LmFwcGVuZCgibmFtZSIsIHRoaXMubmFtZSk7CiAgICAgICAgcHJvZHVjdC5hcHBlbmQoInByaWNlIiwgdGhpcy5wcmljZSk7CiAgICAgICAgcHJvZHVjdC5hcHBlbmQoImNhdGVnb3JpZXMiLCB0aGlzLmNhdGVnb3JpZXMpOwogICAgICAgIHByb2R1Y3QuYXBwZW5kKCJpbWFnZSIsIHRoaXMuaW1hZ2UpOwoKICAgICAgICBjb25zb2xlLmxvZygiRW50cm8gY29uIGltYWdlbiIsIHByb2R1Y3QpOwogICAgICAgIHJlcXVlc3QgPSBpbnNlcnRQcm9kdWN0V2l0aEltYWdlKHByb2R1Y3QpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHByb2R1Y3QgPSB7CiAgICAgICAgICBjb2RlOiB0aGlzLmNvZGUsCiAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsCiAgICAgICAgICBwcmljZTogdGhpcy5wcmljZSwKICAgICAgICAgIGNhdGVnb3JpZXM6IHRoaXMuY2F0ZWdvcmllcywKICAgICAgICB9OwoKICAgICAgICBjb25zb2xlLmxvZygiRW50cm8gc2luIGltYWdlbjoiLCBwcm9kdWN0KTsKICAgICAgICByZXF1ZXN0ID0gaW5zZXJ0UHJvZHVjdChwcm9kdWN0KTsKICAgICAgfQoKICAgICAgY29uc29sZS5sb2cocmVxdWVzdCk7CiAgICAgIHJlcXVlc3QKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+CiAgICAgICAgICB0aGlzLm9wZW5TdWNjZXNzRGlhbG9nKAogICAgICAgICAgICAiU2UgaGEgY3JlYWRvIGVsIHByb2R1Y3RvOiAiICsgcmVzcG9uc2UuZGF0YS5faWQKICAgICAgICAgICkKICAgICAgICApCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7CiAgICAgICAgICB0aGlzLm9wZW5FcnJvckRpYWxvZygiRXJyb3IgYWwgZ3VhcmRhciBlbCBwcm9kdWN0byIpOwogICAgICAgIH0pOwogICAgfSwKICAgIGFjdHVhbGl6YXIoKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLmNvZGUgPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgdGhpcy5jb2RlID09ICIiIHx8CiAgICAgICAgdGhpcy5uYW1lID09IHVuZGVmaW5lZCB8fAogICAgICAgIHRoaXMubmFtZSA9PSAiIiB8fAogICAgICAgIHRoaXMucHJpY2UgPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgdGhpcy5wcmljZSA9PSAiIgogICAgICApIHsKICAgICAgICB0aGlzLm9wZW5FcnJvckRpYWxvZygiSW5ncmVzZSBsb3MgY2FtcG9zIG9ibGlnYXRvcmlvcyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgcHJvZHVjdCA9IHsKICAgICAgICBjb2RlOiB0aGlzLmNvZGUsCiAgICAgICAgbmFtZTogdGhpcy5uYW1lLAogICAgICAgIHByaWNlOiB0aGlzLnByaWNlLAogICAgICAgIGNhdGVnb3JpZXM6IHRoaXMuY2F0ZWdvcmllcywKICAgICAgfTsKICAgICAgdXBkYXRlUHJvZHVjdCh0aGlzLmNvZGUsIHByb2R1Y3QpCiAgICAgICAgLnRoZW4oKCkgPT4KICAgICAgICAgIHRoaXMub3BlblN1Y2Nlc3NEaWFsb2coIlNlIGhhIGFjdHVhbGl6YWRvIGVsIHByb2R1Y3RvOiAiICsgdGhpcy5jb2RlKQogICAgICAgICkKICAgICAgICAuY2F0Y2goKCkgPT4gdGhpcy5vcGVuRXJyb3JEaWFsb2coIkVycm9yIGFsIGFjdHVhbGl6YXIgZWwgcHJvZHVjdG8iKSk7CiAgICB9LAogICAgb3BlblN1Y2Nlc3NEaWFsb2cobWVuc2FqZSkgewogICAgICB0aGlzLnN1Y2Nlc3NNZXNzYWdlID0gbWVuc2FqZTsKICAgICAgdGhpcy5zdWNjZXNzU2hvdyA9IHRydWU7CiAgICB9LAogICAgY2xvc2VTdWNjZXNzRGlhbG9nKCkgewogICAgICB0aGlzLnN1Y2Nlc3NTaG93ID0gZmFsc2U7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvcHJvZHVjdHMiKTsKICAgIH0sCiAgICBvcGVuRXJyb3JEaWFsb2cobWVuc2FqZSkgewogICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IG1lbnNhamU7CiAgICAgIHRoaXMuZXJyb3JTaG93ID0gdHJ1ZTsKICAgIH0sCiAgICBjbG9zZUVycm9yRGlhbG9nKCkgewogICAgICB0aGlzLmVycm9yU2hvdyA9IGZhbHNlOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Edit.vue","sourceRoot":"src/views/products","sourcesContent":["<template>\n  <v-container>\n    <h1>{{ title }}</h1>\n    <v-file-input\n      v-if=\"!isEdit\"\n      v-model=\"image\"\n      accept=\"image/*\"\n      label=\"File input\"\n    ></v-file-input>\n    <v-text-field label=\"Code *\" v-model=\"code\" :rules=\"rules\"></v-text-field>\n    <v-text-field label=\"Name *\" v-model=\"name\" :rules=\"rules\"></v-text-field>\n    <v-text-field label=\"Price* \" v-model=\"price\" :rules=\"rules\"></v-text-field>\n    <v-combobox\n      v-model=\"categories\"\n      chips\n      clearable\n      label=\"Categories\"\n      multiple\n      solo\n    >\n      <template v-slot:selection=\"{ attrs, item, select, selected }\">\n        <v-chip\n          v-bind=\"attrs\"\n          :input-value=\"selected\"\n          close\n          @click=\"select\"\n          @click:close=\"remove(item)\"\n        >\n          <strong>{{ item }}</strong>\n        </v-chip>\n      </template>\n    </v-combobox>\n    <v-btn color=\"primary\" v-if=\"!isEdit\" @click=\"guardar()\">Guardar</v-btn>\n    <v-btn color=\"success\" v-if=\"isEdit\" @click=\"actualizar()\"\n      >Actualizar</v-btn\n    >\n\n    <SuccessMessage\n      :message=\"successMessage\"\n      :snackbar=\"successShow\"\n      :close=\"closeSuccessDialog\"\n    ></SuccessMessage>\n    <ErrorMessage\n      :message=\"errorMessage\"\n      :snackbar=\"errorShow\"\n      :close=\"closeErrorDialog\"\n    ></ErrorMessage>\n  </v-container>\n</template>\n\n<script>\nimport {\n  insertProduct,\n  getProduct,\n  updateProduct,\n  insertProductWithImage,\n} from \"../../services/Products.service\";\nimport SuccessMessage from \"../../components/SuccessMessage.vue\";\nimport ErrorMessage from \"../../components/ErrorMessage.vue\";\n\nexport default {\n  components: {\n    SuccessMessage,\n    ErrorMessage,\n  },\n  data() {\n    return {\n      title: \"New product\",\n      code: 0,\n      name: \"\",\n      price: 0,\n      categories: [],\n      image: null,\n      isEdit: false,\n      successMessage: \"\",\n      successShow: false,\n      errorMessage: \"\",\n      errorShow: false,\n      rules: [(value) => !!value || \"Requerido.\"],\n    };\n  },\n  created() {\n    console.log(\"tiene code: \" + this.$route.params.code);\n    const code = this.$route.params.code;\n    if (code != undefined) {\n      getProduct(code)\n        .then((response) => {\n          const product = response.data;\n          this.code = product.code;\n          this.name = product.name;\n          this.price = product.price;\n          this.categories = product.categories;\n\n          this.title = \"Edit product\";\n          this.isEdit = true;\n        })\n        .catch(() => this.openErrorDialog(\"Datos no encontrados\"));\n    }\n  },\n  methods: {\n    guardar() {\n      if (\n        this.code == undefined ||\n        this.code == \"\" ||\n        this.name == undefined ||\n        this.name == \"\" ||\n        this.price == undefined ||\n        this.price == \"\"\n      ) {\n        this.openErrorDialog(\"Ingrese los campos obligatorios\");\n        return;\n      }\n\n      let request = null;\n      if (this.image != null && this.image != undefined) {\n        const product = new FormData();\n        product.append(\"code\", this.code);\n        product.append(\"name\", this.name);\n        product.append(\"price\", this.price);\n        product.append(\"categories\", this.categories);\n        product.append(\"image\", this.image);\n\n        console.log(\"Entro con imagen\", product);\n        request = insertProductWithImage(product);\n      } else {\n        const product = {\n          code: this.code,\n          name: this.name,\n          price: this.price,\n          categories: this.categories,\n        };\n\n        console.log(\"Entro sin imagen:\", product);\n        request = insertProduct(product);\n      }\n\n      console.log(request);\n      request\n        .then((response) =>\n          this.openSuccessDialog(\n            \"Se ha creado el producto: \" + response.data._id\n          )\n        )\n        .catch((err) => {\n          console.error(err.response.data.message);\n          this.openErrorDialog(\"Error al guardar el producto\");\n        });\n    },\n    actualizar() {\n      if (\n        this.code == undefined ||\n        this.code == \"\" ||\n        this.name == undefined ||\n        this.name == \"\" ||\n        this.price == undefined ||\n        this.price == \"\"\n      ) {\n        this.openErrorDialog(\"Ingrese los campos obligatorios\");\n        return;\n      }\n\n      const product = {\n        code: this.code,\n        name: this.name,\n        price: this.price,\n        categories: this.categories,\n      };\n      updateProduct(this.code, product)\n        .then(() =>\n          this.openSuccessDialog(\"Se ha actualizado el producto: \" + this.code)\n        )\n        .catch(() => this.openErrorDialog(\"Error al actualizar el producto\"));\n    },\n    openSuccessDialog(mensaje) {\n      this.successMessage = mensaje;\n      this.successShow = true;\n    },\n    closeSuccessDialog() {\n      this.successShow = false;\n      this.$router.push(\"/products\");\n    },\n    openErrorDialog(mensaje) {\n      this.errorMessage = mensaje;\n      this.errorShow = true;\n    },\n    closeErrorDialog() {\n      this.errorShow = false;\n    },\n  },\n};\n</script>\n\n<style>\n</style>"]}]}